# エフィーの3rdトレーニングlua

[English](https://github.com/effie3rd/3rd_training_lua/blob/main/README.md)
[インストール](#インストール)\
\
[![PV](https://img.shields.io/badge/YouTube-%23FF0000.svg?logo=YouTube&logoColor=white)](https://youtu.be/k8VYlQ2uFLI)\

### 主な機能
  - ガードシステム書き直し
  - フレームデータモデル作り直し
  - 特殊なトレーニングモード
  - 新しい設定や表示
  - UI再設計

### 予測
  - 移動予測はサブピクセル位置と速度を使用
  - ガード不能、天狗石、星影円舞などブロれる
  - 起き上がり予測 ― セーブステートでロードからダミーがリバーサルをできる

### メニュー再設計
  - 透明背景と読める文字！
  - ダミーメニュー再編成
    - 技名とボタンで反撃を選択
    - 必殺技の入力を表示
    - 仕込みを反撃として選択可能（ガードジャンプに追加設定不要）
      - ガードジャンプ、ガードジャンプ＋ブロ、しゃがみグラップ、最遅グラップ、前下、下前、ブロダッシュ
  - ボタン様式、メニューテーマ
  - 日本語対応

### 新設定
  - 初段ヒット後でガード
  - 下ブロ優先
  - nヒット後に赤ブロ
  - nヒット後に反撃
  - 反撃遅延
  - 連打 ― ピヨリや掴みから脱出
  - オートブロ、普遍キャンセル、無限空中コンボ、無限飛び道具

### 新しい表示
  - 攻撃棒: 直近の2つの攻撃のダメージやスタンを比較するコンパクト表示
  - 攻撃距離: 直近1～3つの攻撃の最大範囲を表示
  - ガード方向: ダミーが使用した入力を表示。表裏にとって良い
  - 赤ブロミス: 赤ブロが失敗した時に、何フレームずれていたか赤い数字で表示する
  - スタンタイマー: 残りピヨリ時間を表示
  - 空中時間: 相手がコンボ不能になった時に青くなる（2フレーム遅延あり。情報源はゲージを参照）
  - ブロ・ため
    - デザイン調整
    - プレイヤー付けコードを調整
    - ブロ表示をコンパクト化
    - 360・720入力、電刃を追加
  - 有利フレーム表示をアニメーション化

### 特殊トレーニングモード
  - 防御
  - 飛び込み
  - 差し合い
  - ガード不能
  - 幻影陣防御

### その他
  - ロード時間削減：フレームデータをゲーム起動後に非同期で読み込み。ゲームウィンドウが約0.5秒早く現れる
  - ランダムキャラ選択
  - ステージ強行
  - 体力、ゲージ、スタン回復を調整
  - 記録再生の不整合を修正（たまに暗転が1フレーム遅れて同期ずれを起こす問題）
  - 攻撃データのスタン値が、攻撃の間に相手が回復した分を反映するよう変更
  - 有利フレームの計算がプレイヤー移動を含める
  
### 技術的な変更点
  - リファクタリング
  - メモリアドレス追加
    - 速度、加速度、スタン状態、スタン値（小数）、グラフィックモード、360ため、空中コンボタイマー、タイムドSA状態、電刃状態、天狗石状態、技タイプ、ヒットタイプ／強度、ブロ状態、など
  - フレームデータはこのフィールドを使用
    - アニメーションレベル：name, frames, hit_frames, idle_frames, loops, pushback, advantage, uses_velocity, air, infinite_loop, max_hits, cooldown, self_chain, exceptions, landing_height
    - フレームレベル：hash, boxes, movement, velocity, acceleration, loop, next_anim, optional_anim, wakeup, bypass_freeze, projectile, ignore_motion
  - キャラクターセレクト　ー　ボス選択を一貫させた。ボス選択禁止やキャラ強行を追加した
  - デバグメニューを更新

### バグ修正
  - 繋がった攻撃や飛び道具の探知
  - 色々攻撃のガード能力
  - 同一技連続ジャストタイミングで出したらダミーがガードしなかった
  - 画面端で相手の裏にジャンプ攻撃したらダミーがガードしなかった
  - ため技や360技のリバーサル反撃一貫させた

### インストール
<table><tr><td>ファイルを`fbneo-training-mode`ディレクトリに貼り付け、すべて上書きしてください<br>ファイケーのメニューから「Training」をクリックして起動する。</td></tr></table>
注意：`Auto Frameskip`を有効にすると問題が発生する。
